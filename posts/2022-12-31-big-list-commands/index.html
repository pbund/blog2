<!doctype html><html lang=en-us><head><title>Big List of mostly Cisco commands // Grokking Cisco with oldpaul99</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Paul Bundschuh"><meta name=description content><link rel=stylesheet href=/blog2/css/main.min.9e9c6027c30f5aa9423b581bd9cddd1ddc66088adb9c2604f89eb5828efea5a1.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Big List of mostly Cisco commands"><meta name=twitter:description content="This is a compendium of useful or interesting commands and tips I’ve gathered over the years. Mainly these apply to Cisco equipment, but there are a couple of Juniper and Linux commands. I almost always show example commands since my brain processes them better.
Warning: Some of these command are dangerous, where they might hose your system if used. Don’t come crying to me if this happens. Research their usage before any relying on them for production systems."><meta property="og:title" content="Big List of mostly Cisco commands"><meta property="og:description" content="This is a compendium of useful or interesting commands and tips I’ve gathered over the years. Mainly these apply to Cisco equipment, but there are a couple of Juniper and Linux commands. I almost always show example commands since my brain processes them better.
Warning: Some of these command are dangerous, where they might hose your system if used. Don’t come crying to me if this happens. Research their usage before any relying on them for production systems."><meta property="og:type" content="article"><meta property="og:url" content="https://pbund.github.io/blog2/posts/2022-12-31-big-list-commands/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-31T10:46:43-06:00"><meta property="article:modified_time" content="2022-12-31T10:46:43-06:00"></head><body><header class=app-header><a href=https://pbund.github.io/blog2/><img class=app-header-avatar src=/blog2/avatar.jpg alt="Paul Bundschuh"></a>
<span class=app-header-title>Grokking Cisco with oldpaul99</span><p>Blogs about Cisco networking and other technical topics</p></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Big List of mostly Cisco commands</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Dec 31, 2022</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>9 min read</div></div></header><div class=post-content><p>This is a compendium of useful or interesting commands and tips I’ve gathered over the years. Mainly these apply to Cisco equipment, but there are a couple of Juniper and Linux commands. I almost always show example commands since my brain processes them better.</p><p>Warning: Some of these command are dangerous, where they might hose your system if used. Don’t come crying to me if this happens. Research their usage before any relying on them for production systems. But largely they are more useful than dangerous.</p><h1 id=useful-commands>Useful commands</h1><ul><li>To activate serial controllers and interfaces, when they are first installed, especially with a multiflex t1 card, not a wic-1dsu-t1-v2 type card<ul><li><code>card type t1 0 1</code> (example) will cause controllers to appear in config</li><li><code>controller t1 0/1</code> > <code>channel-group 0 timeslots 1-24</code> will cause s0/1 interface to appear in config</li></ul></li><li>use ctrl-v or esc+q, then a ?, to enter a ? in a CLI password</li><li>term mon => enables you see logging/debug output in a telnet/ssh session</li><li>term no mon => turns it off, should also use no logging console at the same time, because it causes cpu interrupts which are cpu intensive</li><li>sh context, env, inventory, diag are good cmds</li><li>send log paul is great => puts “%sys-2-logmsg: Message from 1(oldpaul): paul is great” in the logs, good way to annotate them</li><li>send * => send other logged in users a message</li><li>send * => from a terminal access server, send following cmds to all connected hosts, whether active or not (i.e. end, config t, )</li><li>Logging<ul><li>logging discriminator Foo msg-body includes starttext.*endtext => define discriminator</li><li>logging buffered discriminator Foo 32768 => only log messages to buffer that match the discriminator</li><li>logging rate-limit console 1 except critical => rate limit console messages to 1 per sec, except for critical and more important (lower) level msgs</li><li>ip access-list log-update threshold 1 => display log messages for each ACE (in an ACL) hit, as opposed to waiting for default 5 minutes, log acl</li><li>ip access-list logging interval 100 => one log-enabled ACE packet per 100 ms will be process-switched; limits the effects of ACL logging-induced process switching</li></ul></li><li>term exec prompt timestamp => display date/time/cpu on show cmds, in your current session</li><li>line vty 0 15> exec prompt timestamp => same thing, but permanently for all users</li><li>term escape-character 3 => enable ctrl-c instead of ctrl-shift-6, just for this login session</li><li>escape-character 3 => on console/vty lines, enable ctrl-c instead of ctrl-shift-6 everytime you login</li><li>escape-character x => same thing, but use the letter x</li><li>wr, reload in 010, do changes w/o saving, if you are cutoff then let router reload, but if changes work then “reload cancel”</li><li>logging synchronous, on console and vty lines => helps with screen clutter</li><li>delete /for /rec , delete directory and all its contents</li><li>verify /md5 foo.bin => show md5 for file foo.bin</li><li>crypto key gen rsa &lt;#> &ndash; transport input ssh => enables ssh, also requires either ip domain name to be set or hostname, or both</li><li>no ip domain-lookup => do not do a dns lookup when you mistype a cmd</li><li>exception dump 1.1.1.1 => look this up, think it sends crash dump to 1.1.1.1</li><li>tftp-server flash foo.bin 99 => make your router a tftp server of file foo.bin, to hosts allowed by acl 99, can use this multiple times</li><li>boot system foo.bin 1.1.1.1 => tftp boot from image foo.bin on host 1.1.1.1</li><li>copy http://user1:pword@1.1.1.1/dir/foo.bin flash: => copy file from web server</li><li>sh run | i p.*sum => show lines with an “p” in it, then arbitrary text, then “sum”</li><li>on long output cmds, when “&ndash;More—“ appears at bottom, can use /, followed by text, to jump to that text</li><li>or use + text, which will grep the rest of output for that text</li><li>or use – text, which will grep –v the rest of the output for that text</li><li>debug ip tcp transactions => debug tcp session</li><li>example TCL script, which pings multiple IPs</li></ul><pre tabindex=0><code>tclsh
  foreach i {
  150.1.1.1
  204.12.1.254
  } {ping $i repeat 2}
</code></pre><ul><li>example switch Macro script, which pings multiple IPs:</li></ul><pre tabindex=0><code>conf t
macro name Ping
Enter macro commands one per line. End with the character &#39;@&#39;.
do ping 150.1.1.1 repeat 3 source Lo0
do ping 204.12.1.254 repeat 3 source Lo0
@
switch(config)# macro global apply Ping 
</code></pre><ul><li>another way to TCL ping IPs, but create executable file:</li></ul><pre tabindex=0><code>tclsh
  puts [open &#34;flash:foo.tcl&#34; w+] {
    foreach i {
      150.1.1.1
      204.12.1.254
      } { puts [ exec &#34;ping $i repeat 2&#34; ] }
  }
tclquit
tclsh foo.tcl
</code></pre><ul><li>Use TCL to batch IOS commands:</li></ul><pre tabindex=0><code>tclsh
  ios_config &#34;int g0/0” “speed auto” “duplex auto”
  tclquit
</code></pre><ul><li>Use TCL to create blank config file in flash:</li></ul><pre tabindex=0><code>tclsh
  puts [ open &#34;flash:blank.cfg&#34; w+] {
  version 15.4
  !
  end
}
tclquit
</code></pre><ul><li>Change to default (blank) config without rebooting, using local blank config file created in previous step, takes 10-15 sec: <code>config replace flash:blank.cfg</code></li><li>Use EEM to wait for two events to occur, in any order, then take some action:</li></ul><pre tabindex=0><code>event manager applet Foo
  event tag e1 syslog pattern paul2
  event tag e2 syslog pattern jill2
  trigger
    correlate event e1 andM event e2
  action 1.0 syslog msg “write some msg to syslog”
  action 2.0 cli command “show clock | append foo.txt”
</code></pre><ul><li>Enable Shell Commands<ul><li>Enable shell cmds in this session or permanently, good on IOS 15.1 and up. Enables multi-pipes, grep, man, cat, cut, echo, head, tail, sort, nl, redirect to file, and unix scripting for cmds and functions (see David Bombal youtube videos)<ul><li>term shell => for this session only</li><li>conf t> shell processing full => for everyone</li></ul></li><li>example shell cmds on router<ul><li>sh ip route | grep –i loopback | grep –v 123</li><li>sh run | grep –b banner | grep –u alias => start with first line containing banner, end before line containing alias</li></ul></li><li>example shell script to ping 3 consecutive IPs, from exec command line<ul><li>for x in 1 2 3</li><li>do</li><li>ping 10.10.10.$x</li><li>done => starts the three pings</li></ul></li><li>example Linux function, stays around for session<ul><li>function testping (){</li><li>ping 10.10.1.1</li><li>ping 10.10.1.2</li><li>}</li><li>testping => run the function</li><li>sh shell function => display above function and others</li></ul></li></ul></li><li>sh file md5sum => Nexus md5 verification</li><li>hardware access-list allow deny ace => Nexus 6.1(3) and up, allow</li><li>ip tcp synwait-time 10 => lowers tcp timeout from default 30s to 10s</li><li>sh power inline => show which ports are powering POE devices</li><li>mac address-table notification mac-move => shows port flapping on switch</li><li>int> mac-address-table 0000.0000.0001 => change my mac address</li><li>clear spanning-tree counters</li><li>sh spanning-tree interface f0/0 detail => show # of bpdus sent/received</li><li>sh spanning-tree detail | incl ieee|from|is exec => shows STP TCN events on a switch</li><li>sh spanning-tree detail | incl ieee|from|occur => shows STP TCN events on a switch</li><li>control-plane host > management-interface f2/0 allow ssh telnet tftp => enable MPP on one interface</li><li>test aaa group tacacs+ Foouser Foopassword legacy=> test aaa</li><li>sh ip alias => shows all IPs associated with this device</li><li>mac address-table static vlan 1 int f0/1 => statically set mac</li><li>mac address-table static vlan 1 drop => drop traffic to this mac</li><li>no mac address-table learning vlan 1 => turn off all learning on vlan 1, would require static mac entries to work</li><li>show memory failures alloc => show memory failures</li><li>sh snmp mib => show all mib values</li><li>sh snmp mib ifmib ifindex details => shows interface ifindex values</li><li>snmp-server ifindex persist => maintain same ifindex values</li><li>3650 packet capture commands (and probably all IOS-XE devices)</li></ul><pre tabindex=0><code>no monitor capture 3
monitor cap 3 int g0/0/0 both match any buffer size 2 (all traffic both directions)
monitor cap 3 start
show monitor cap =&gt; see details about all capture sessions
show monitor cap 3 buff	brief =&gt; see captured packets on screen
show monitor cap 3 buff	=&gt; see details about packet capture buffer
monitor cap 3 export flash:foo.pcap
copy foo.pcap scp://172.16.100.100
</code></pre><ul><li>could also use capture cmds that filter what type of traffic to capture<ul><li>monitor cap 3 match ipv4 any host 192.168.1.1 buffer size 2 int g1/0/3 both (simple filter)</li><li>monitor cap 3 access-list Foo buffer size 2 int g1/0/3 both (ACL filter)</li></ul></li><li>3900 packet capture (this version works on 3900 routers)</li></ul><pre tabindex=0><code>monitor capture buffer Paulbuffer size 2048 max-size 100 linear
ip access-list ext Foo
permit ip host 1.1.1.1 any
monitor capture buffer Paulbuffer filter access-list Foo
monitor capture point ip cef Paulpoint g0/1 both
monitor capture point associate Paulpoint Paulbuffer
monitor capture point start Paulpoint  (can use “stop” too)
sh monitor capture point Paulpoint
sh monitor capture buffer Paulbuffer parameters (show # of packets captured)
sh monitor capture buffer Paulbuffer  (shows captured packets)
sh monitor capture buffer Paulbuffer dump  (show contents of packets)
monitor capture buffer Paulbuffer export tftp://1.1.1.1/capture.pcap
</code></pre><ul><li>to decrypt a layer 7 encypted password directly on a router, paste the encrypted pw in a key chain, then do a “show key chain” to show the plaintext version</li><li>key chain Foo > key 1 > key-string 7 7 0522282A</li><li>show key chain</li><li>“Key-chain Foo: key 1 == text “INE” …”</li><li>sh ip bgp version recent 10 => ten most recent bgp best paths</li><li>sh ip route | include 00:00 => show most recent RIB updates</li><li>show facility-alarm status => on asr1001x, show alarms that activate idiot/critical lights (when port is configged up but status down)</li><li>test cable-diagnostics tdr interface g0/24, then sh cable-diag tdr int g0/24</li></ul><hr><ul><li>ACI cli cmds</li></ul><hr><ul><li></li><li>APIC CLI cmds</li></ul><hr><ul><li>show endpoint ip => show where ip is</li><li>show vpc map => maps vpcs to interface policy name</li><li>show port-channel map => similar to sh vpc map but shows less info</li><li>show stats granularity 15min leaf 203 interface ethernet 1/5</li><li>sh run</li><li>sh version</li><li>sh controller</li><li>sh switch => shows all spines/leaves, with IPx3/ser#/ver</li><li>acidiag fnvread => subset of show switch</li><li>df -h</li><li>sh tenant</li><li>sh bridge-domain</li><li>sh vrf</li><li>sh vlan</li><li>sh vlan-domain</li><li>show endpoint => aka &rsquo;s end&rsquo;, big list of macs/IPs, ctrl-c works</li><li>show endpoint mac 2880.23a4.2260 => shows the leaf and port where it sees this mac</li><li>sh endpoints leaf 201 interface ethernet 1/1-128</li><li>fabric 101-102 show version | grep supervisor => show model numbers of spines</li><li>fabric 201-202 show ip int brief vrf all</li><li></li><li>Spine/Leaf CLI cmds</li></ul><hr><ul><li>(must type out whole word &lsquo;show&rsquo;)</li><li>show int brief => shows which ints are up, also speed/trunk status</li><li>show int description => show port description, aka &lsquo;show int des&rsquo;q</li><li>show ip int brief => similar to IOS, also shows VRFs</li><li>show cdp neighbor (detail) => aka &lsquo;show cdp n&rsquo;</li><li>show lldp neighbor (detail) => aka &lsquo;show ll n d&rsquo;</li><li>show version</li><li>show hardware => show version + show inventory</li><li>show vrf</li><li>show vlan</li><li>show interface => big list, ctrl-c works, so does piping to &lsquo;more&rsquo;</li><li>show interface e1/1</li><li>show interface | grep ^[A-Z] | grep &lsquo;is up&rsquo; => show all up interfaces</li><li>show interface | egrep &lsquo;^[A-Z].*is up|30 sec&rsquo; | grep -v &rsquo; 0 packets&rsquo; => show rates on up interfaces</li><li>show interface e 1/1-3 switchport|status|transceiver => show various info for these three interfaces</li><li>acidiag fnvread => subset of show switch</li><li>show endpoint mac 0050.56aa.1081 => not as much info as when entered on APIC</li><li>show mac address-table | grep =></li><li>show vpc</li><li>iping , should specify tenant:vrf with &lsquo;-V tenant:vrf&rsquo; or it will use mgmt vrf</li><li>iping -V anc_prod:anc_prod_main_vrf -S 151.169.2.1 151.169.108.55</li><li></li><li>Juniper firewall CLI cmds</li></ul><hr><ul><li>show interface terse</li><li>show route 1.1.1.1</li><li>show chassis alarm</li><li>show chassis cluster status</li><li>show chassis fpc details</li><li>show log mess | last 50</li></ul></div><div class=post-footer></div></article></main></body></html>